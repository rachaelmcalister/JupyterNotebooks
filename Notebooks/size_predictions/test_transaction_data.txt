SELECT
    t.garment_category_id,
    t.profile_id,
    t.garment_id,
    t.order_date AS date,
    t.quantity,
    t.return_quantity,
    t.size,
    b.base_size_id,
    g.sizing_range_id
FROM activity_johnlewis.v_transaction_labelled_garments AS t
INNER JOIN activity_johnlewis.v_garment_this_partner AS g
ON t.garment_id = g.garment_id
LEFT JOIN activity_johnlewis.temp_d_sku_garment_id_base_size AS b
ON t.garment_id = b.garment_id AND t.size = b.size
WHERE profile_complete = true AND profile_signup_finished_at::date <= order_day
    AND '2019-11-01' <= order_day AND order_day < '2019-12-01'
    AND '2019-01-01' <= profile_signup_finished_at AND profile_signup_finished_at < '2019-11-01'
    AND base_size_id IS NOT NULL